---
title: "graphql-eslintã‚’ä½¿ç”¨ã—ã¦GraphQLã®å‘½åè¦å‰‡ã‚’å¼·åˆ¶ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œã‚‹"
emoji: "ğŸ’¬"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["graphql", "eslint", "typescript"]
published: true
publication_name: "buyselltech"
---

æ™®æ®µã®æ¥­å‹™ã§ã¯Apollo Clientã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€ä»¥å‰å€‹äººé–‹ç™ºã§Relayã‚’ä½¿ç”¨ã—ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ãã®éš›ã«ã€Relayã«ã¯Operationã‚„Fragmentã®[å‘½åè¦å‰‡ã‚’å¼·åˆ¶ã™ã‚‹æ©Ÿèƒ½](https://github.com/facebook/relay/blob/main/compiler/crates/relay-transforms/src/validations/validate_module_names/mod.rs#L27-L81)ãŒã‚ã‚Šã€ã“ã‚ŒãŒå€‹äººçš„ã«ã¯ã‹ãªã‚Šé–‹ç™ºè€…ä½“é¨“ãŒè‰¯ã‹ã£ãŸã§ã™ã€‚

ãã“ã§ã€Apollo Clientã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã§ã‚‚åŒã˜ã“ã¨ã‚’ã—ãŸã„ã¨æ€ã„ã€GraphQLã®å‘½åè¦å‰‡ã‚’å¼·åˆ¶ã™ã‚‹ESLintã®ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸï¼
ä»Šå›ã¯graphql-eslintã®ä½¿ã„æ–¹ã‚‚è¸ã¾ãˆã¦ã€ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã«ã¤ã„ã¦ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ï¼

# graphql-eslintã«ã¤ã„ã¦

graphql-eslintã¨ã¯The Guildã«ã‚ˆã£ã¦å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ESLintã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã€GraphQLã®ã‚¹ã‚­ãƒ¼ãƒã‚„ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¯¾ã—ã¦Lintã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚[ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½](https://the-guild.dev/graphql/eslint/docs/custom-rules)ã‚‚æä¾›ã•ã‚Œã¦ãŠã‚Šã€ä»Šå›ã¯ä¸»ã«ã“ã¡ã‚‰ã®æ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

https://the-guild.dev/graphql/eslint/docs

å‘½åè¦å‰‡ã«é–¢ã™ã‚‹ãƒ«ãƒ¼ãƒ«ã¯å­˜åœ¨ã—ã¦ã„ã¦ã€ç°¡å˜ãªå‘½åè¦å‰‡ã§ã‚ã‚Œã°ã“ã®ãƒ«ãƒ¼ãƒ«ã§è¨­å®šå¯èƒ½ã§ã™ã€‚ä»Šå›å®Ÿç¾ã—ãŸã‹ã£ãŸå‘½åè¦å‰‡ã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«åã‚„ã‚¹ã‚­ãƒ¼ãƒã«ä¾å­˜ã™ã‚‹éƒ¨åˆ†ãŒã‚ã‚Šã€æ—¢å­˜ã®ãƒ«ãƒ¼ãƒ«ã§ã¯å®Ÿç¾ã§ããªã‹ã£ãŸã®ã§ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚

https://github.com/dimaMachina/graphql-eslint/blob/master/packages/plugin/src/rules/naming-convention.ts

# ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ä½œæˆ

Relayã‚’å‚è€ƒã«ã—ã¦ã€å‘½åè¦å‰‡ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«å®šã‚ã¾ã—ãŸã€‚ã“ã®å‘½åè¦å‰‡ã‚’å¼·åˆ¶ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚

- Operation/Fragmentåã¯ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã§å§‹ã‚ã‚‹
- Operationåã¯ç¨®åˆ¥ï¼ˆ`Query`, `Mutation`ï¼‰ã§çµ‚ã‚ã‚‹
- Fragmentåã¯`_<å‹å>`ã§çµ‚ã‚ã‚‹

æœ€çµ‚çš„ãªã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®å®Ÿè£…ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ã‚µãƒ³ãƒ—ãƒ«ã®ãƒªãƒã‚¸ãƒˆãƒªã‚‚ä½œæˆã—ã¦ã‚ã‚‹ã®ã§ã€ãã¡ã‚‰ã‚‚ä½µã›ã¦å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

:::details æœ€çµ‚çš„ãªã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®å®Ÿè£…

```typescript
import {
  requireGraphQLSchemaFromContext,
  type GraphQLESLintRule,
} from "@graphql-eslint/eslint-plugin";
import { GraphQLESTreeNode } from "@graphql-eslint/eslint-plugin/cjs/estree-converter/types";
import { NameNode } from "graphql";
import * as path from "path";

const RULE_ID = "graphql-operation-naming-convention";

const rule: GraphQLESLintRule<[], true> = {
  meta: {
    type: "suggestion",
    docs: {
      description: "Require names to follow specified conventions.",
      category: ["Operations"],
    },
    hasSuggestions: true,
    schema: [],
  },
  create(context) {
    requireGraphQLSchemaFromContext(RULE_ID, context);

    const report = (
      node: GraphQLESTreeNode<NameNode, true>,
      message: string,
      suggestedNames: string[],
    ) => {
      context.report({
        node,
        message: `${message}`,
        suggest: suggestedNames.map((suggestedName) => ({
          desc: `Rename to \`${suggestedName}\``,
          fix: (fixer) => fixer.replaceText(node as any, suggestedName),
        })),
      });
    };

    const parsedPath = path.parse(context.physicalFilename);
    const dirname = parsedPath.dir.split("/").pop() ?? "";
    const moduleName = parsedPath.name === "index" ? dirname : parsedPath.name;
    const upperCamelModuleName =
      moduleName.charAt(0).toUpperCase() + moduleName.slice(1);

    return {
      OperationDefinition(node) {
        if (!node.name) {
          context.report({
            node,
            message: "OperationDefinition should have a name",
          });
          return;
        }

        const operationName = node.name.value;

        const expectedPrefix = upperCamelModuleName;
        const expectedSuffix =
          node.operation.charAt(0).toUpperCase() + node.operation.slice(1);
        const expectedOperationName = new RegExp(
          `^${expectedPrefix}.*${expectedSuffix}$`,
        );

        if (!expectedOperationName.test(operationName)) {
          report(
            node.name,
            `Operation "${operationName}" should have prefix "${expectedPrefix}" and suffix "${expectedSuffix}"`,
            [`${expectedPrefix}${expectedSuffix}`],
          );
        }
      },
      FragmentDefinition(node) {
        const fragmentName = node.name.value;
        const gqlType = node.typeInfo().gqlType?.toString();
        if (!gqlType) {
          context.report({
            node,
            message: "FragmentDefinition should have a type",
          });
          return;
        }

        const expectedPrefix = upperCamelModuleName;
        const expectedSuffix = `_${gqlType}`;
        const expectedFragmentName = new RegExp(
          `^${expectedPrefix}.*${expectedSuffix}$`,
        );

        if (!expectedFragmentName.test(fragmentName)) {
          report(
            node.name,
            `Fragment "${fragmentName}" should have prefix "${expectedPrefix}" and suffix "${expectedSuffix}"`,
            [`${expectedPrefix}${expectedSuffix}`],
          );
        }
      },
    };
  },
};

module.exports = rule;
export default rule;
```

:::

https://github.com/KazukiHayase/eslint-graphql-operation-naming-convenstion-sample

## äº‹å‰æº–å‚™

ä¸‹è¨˜ã®è¨˜äº‹ã‚’å‚è€ƒã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ã«ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè¡Œã§ãã‚‹ç’°å¢ƒã‚’æº–å‚™ã—ã¾ã™ã€‚

https://zenn.dev/nus3/articles/b2bc110efd0887442c11

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã‚’ä¸‹è¨˜ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã—ãŸã€‚
ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã¯`eslint-rules/graphql-operation-naming-convention.ts`ã«å®Ÿè£…ã—ã¦è¡Œãã“ã¨ã«ãªã‚Šã¾ã™ã€‚

```
.
â”œâ”€â”€ eslint-rules
â”‚Â Â  â”œâ”€â”€ dist
â”‚Â Â  â”œâ”€â”€ tests
â”‚Â Â  â”‚   â””â”€â”€ graphql-operation-naming-convention.test.ts
â”‚Â Â  â””â”€â”€ graphql-operation-naming-convention.ts
â”œâ”€â”€ eslint.config.js
â””â”€â”€ package.json
```

ãƒ“ãƒ«ãƒ‰ç”¨ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç”¨æ„ã—ã¦ã€`eslint.config.js`ã«ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚

```json:package.json
"scripts": {
    "build-eslint": "tsc eslint-rules/*.ts --outDir eslint-rules/dist --skipLibCheck",
},
```

```js:eslint.config.js
const rulesDirPlugin = require("eslint-plugin-rulesdir");
rulesDirPlugin.RULES_DIR = "eslint-rules/dist";

module.exports = [
  {
    files: ["src/**/*.graphql"],
    plugins: {
      customRule: rulesDirPlugin,
    },
    rules: {
      "customRule/graphql-operation-naming-convention": "error",
    },
  },
];
```

ã“ã‚Œã§ãƒ­ãƒ¼ã‚«ãƒ«ã«ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

## ãƒ«ãƒ¼ãƒ«ã®å‹å®šç¾©

ã“ã“ã‹ã‚‰ã¯å®Ÿéš›ã«ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

ã¾ãšã¯å¤§æ ã®ä½œæˆã§ã™ã€‚graphql-eslintã‹ã‚‰`GraphQLESLintRule`ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã®å‹ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã®ã§ãã¡ã‚‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚
`GraphQLESLintRule`ã¯å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’2ã¤å—ã‘å–ã‚Šã¾ã™ã€‚1ã¤ç›®ã¯ãƒ«ãƒ¼ãƒ«ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®å‹ã§ã€2ã¤ç›®ã¯ãã®ãƒ«ãƒ¼ãƒ«ãŒGraphQLã‚¹ã‚­ãƒ¼ãƒã‚’å¿…è¦ã¨ã™ã‚‹ã‹ã©ã†ã‹ã§ã™ã€‚

```typescript
type GraphQLESLintRule<Options = [], WithTypeInfo extends boolean = false> = {
    meta: Omit<Rule.RuleMetaData, 'docs' | 'schema'> & {
        docs?: RuleDocsInfo<Options>;
        schema: Readonly<JSONSchema> | [];
    };
    create(context: GraphQLESLintRuleContext<Options>): GraphQLESLintRuleListener<WithTypeInfo>;
};
```

ä»Šå›ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ä¸è¦ã§ã€GraphQLã‚¹ã‚­ãƒ¼ãƒã¯å¿…è¦ãªã®ã§ã€ãã‚Œãã‚Œä¸‹è¨˜ã®ã‚ˆã†ã«æŒ‡å®šã—ã¾ã™ã€‚

```typescript:eslint-rules/graphql-operation-naming-convention.ts
import { type GraphQLESLintRule } from "@graphql-eslint/eslint-plugin";

const rule: GraphQLESLintRule<[], true> = {};
```

## GraphQLã‚¹ã‚­ãƒ¼ãƒãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã‹ã®ãƒã‚§ãƒƒã‚¯

ã“ã“ã‹ã‚‰ã¯`create`ã®ä¸­èº«ã‚’å®Ÿè£…ã—ã¦è¡Œãã¾ã™ã€‚

ä»Šå›ä½œæˆã™ã‚‹ãƒ«ãƒ¼ãƒ«ã¯GraphQLã‚¹ã‚­ãƒ¼ãƒãŒå¿…è¦ãªã®ã§ã€ã‚¹ã‚­ãƒ¼ãƒãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚
ãã®ãŸã‚ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ãŒgraphql-eslintã‹ã‚‰æä¾›ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€ãã¡ã‚‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```typescript
import {
  requireGraphQLSchemaFromContext,
  type GraphQLESLintRule,
} from "@graphql-eslint/eslint-plugin";

const RULE_ID = "graphql-operation-naming-convention";

const rule: GraphQLESLintRule<[], true> = {
  create(context) {
    requireGraphQLSchemaFromContext(RULE_ID, context);

    return {};
  },
};
```

ã“ã‚Œã«ã‚ˆã‚Šã€[schemaã‚ªãƒ—ã‚·ãƒ§ãƒ³](https://the-guild.dev/graphql/eslint/docs/getting-started/parser-options#schema)ã‚’è¨­å®šã—ã¦ã„ãªã„å ´åˆã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
Error: Error while loading rule 'customRule/graphql-operation-naming-convention': Rule `graphql-operation-naming-convention` requires `parserOptions.schema` to be set and loaded. See https://bit.ly/graphql-eslint-schema for more info
```

## ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã®å–å¾—

Operation/FragmentåãŒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã§å§‹ã¾ã£ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ãŸã‚ã«ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã‚’å–å¾—ã—ã¾ã™ã€‚
å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«åãŒ`index`ã®å ´åˆã¯è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªåã‚’ã€ãã‚Œä»¥å¤–ã®å ´åˆã¯å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åã¨ã—ã¾ã™ã€‚

```typescript
const rule: GraphQLESLintRule<[], true> = {
   create(context) {
     // ...çœç•¥
 
     const parsedPath = path.parse(context.physicalFilename);
     const dirname = parsedPath.dir.split("/").pop() ?? "";
     const moduleName = parsedPath.name === "index" ? dirname : parsedPath.name;
     const upperCamelModuleName =
       moduleName.charAt(0).toUpperCase() + moduleName.slice(1);
 
     return {};
   },
 };
```

## Operationåã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

æœ¬é¡Œã®å‘½åè¦å‰‡ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

`create`ã®è¿”ã‚Šå€¤ã¯`GraphQLESLintRuleListener`å‹ã§ã€keyã¯[GraphQL AST Nodeå](https://github.com/graphql/graphql-js/blob/main/src/language/ast.ts#L140-L186)ã€valueã¯ãã®Nodeã‚’å¼•æ•°ã¨ã™ã‚‹é–¢æ•°ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

```typescript
type GraphQLESLintRuleListener<WithTypeInfo extends boolean = false> = Record<string, any> & {
    [K in keyof ASTKindToNode]?: (node: GraphQLESTreeNode<ASTKindToNode[K], WithTypeInfo>) => void;
};
```

è¿”ã‚Šå€¤ã¨ãªã‚‹ã“ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€è©²å½“ã®Nodeã«å¯¾ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚
ã“ã“ã§ã¯Operationã«å¯¾ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã—ãŸã„ã®ã§ã€`OperationDefinition`ã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿½åŠ ã—ã¦ã€Operationåã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

```typescript
const rule: GraphQLESLintRule<[], true> = {
  create(context) {
    // ...çœç•¥
    return {
      OperationDefinition(node) {
        if (!node.name) {
          context.report({
            node,
            message: "OperationDefinition should have a name",
          });
          return;
        }

        const operationName = node.name.value;

        const expectedPrefix = upperCamelModuleName;
        const expectedSuffix =
          node.operation.charAt(0).toUpperCase() + node.operation.slice(1);
        const expectedOperationName = new RegExp(
          `^${expectedPrefix}.*${expectedSuffix}$`,
        );

        if (!expectedOperationName.test(operationName)) {
          report(
            node.name,
            `Operation "${operationName}" should have prefix "${expectedPrefix}" and suffix "${expectedSuffix}"`,
            [`${expectedPrefix}${expectedSuffix}`],
          );
        }
      },
    };
  },
};
```

å®Ÿè¡Œæ™‚ã«ã¯graphql-eslintãŒã€GraphQL ASTã‚’ESTreeã®æ§‹é€ ã«å¤‰æ›ã—ã€è©²å½“ã®NodeãŒè¦‹ã¤ã‹ã‚‹ãŸã³ã«ã€å®Ÿè£…ã—ãŸé–¢æ•°ã‚’å®Ÿè¡Œã—ã¦ãã‚Œã¾ã™ã€‚
ãã®ãŸã‚ã€æ‰±ã„ãŸã„Nodeã‚’é¸æŠã—ã¦ã€ãã®Nodeã«å¯¾ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ã ã‘ã§ã„ã„ã®ã§ã€éå¸¸ã«ç°¡å˜ã«GraphQL ASTã‚’æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚

## Fragmentåã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

Operationåã®å ´åˆã¨åŒã˜ãã€Fragmentã«å¯¾ã™ã‚‹å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã«ã€`FragmentDefinition`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¾ã™ã€‚

```typescript
const rule: GraphQLESLintRule<[], true> = {
  create(context) {
    // ...çœç•¥
    return {
      OperationDefinition(node) {
          // ...çœç•¥
      },
      FragmentDefinition(node) {
        const fragmentName = node.name.value;
        const gqlType = node.typeInfo().gqlType?.toString();
        if (!gqlType) {
          context.report({
            node,
            message: "FragmentDefinition should have a type",
          });
          return;
        }

        const expectedPrefix = upperCamelModuleName;
        const expectedSuffix = `_${gqlType}`;
        const expectedFragmentName = new RegExp(
          `^${expectedPrefix}.*${expectedSuffix}$`,
        );

        if (!expectedFragmentName.test(fragmentName)) {
          report(
            node.name,
            `Fragment "${fragmentName}" should have prefix "${expectedPrefix}" and suffix "${expectedSuffix}"`,
            [`${expectedPrefix}${expectedSuffix}`],
          );
        }
      },
    };
  },
};
```

Operationåã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨å¤§ããé•ã†ç‚¹ã¯GraphQLã‚¹ã‚­ãƒ¼ãƒã®æƒ…å ±ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹ç‚¹ã§ã™ã€‚
ã‚ã‚‰ã‹ã˜ã‚ã‚¹ã‚­ãƒ¼ãƒãŒæ¸¡ã•ã‚Œã¦ã„ã‚‹ã‹ã®ãƒã‚§ãƒƒã‚¯ã¯è¡Œã£ã¦ã„ã‚‹ã®ã§ã€`node.typeInfo()`ã«ã‚ˆã£ã¦ãã®Nodeã®GraphQLã‚¹ã‚­ãƒ¼ãƒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ä»Šå›ã®ä¾‹ã§ã¯ã€`gqlType`ã§Fragmentã®å‹åã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ãŒã€ä»–ã®æƒ…å ±ã‚‚åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```typescript
type TypeInformation = {
    argument: ReturnType<TypeInfo['getArgument']>;
    defaultValue: ReturnType<TypeInfo['getDefaultValue']>;
    directive: ReturnType<TypeInfo['getDirective']>;
    enumValue: ReturnType<TypeInfo['getEnumValue']>;
    fieldDef: ReturnType<TypeInfo['getFieldDef']>;
    inputType: ReturnType<TypeInfo['getInputType']>;
    parentInputType: ReturnType<TypeInfo['getParentInputType']>;
    parentType: ReturnType<TypeInfo['getParentType']>;
    gqlType: ReturnType<TypeInfo['getType']>;
};
```

# å®Ÿè¡Œçµæœ

ESLintã‚’å®Ÿè¡Œã—ãŸçµæœã¯ä¸‹è¨˜ã«ãªã‚Šã¾ã™ã€‚

:::details å¯¾è±¡ã®.graphqlãƒ•ã‚¡ã‚¤ãƒ«

```graphql:src/components/TodoItem/index.graphql
# OK
query TodoListQuery {
  todos {
    id
    ...TodoList_Todo
  }
}

# NG
query TodoList {
  todos {
    id
    ...TodoList_Todo
  }
}

query TodosQuery {
  todos {
    id
    ...TodoList_Todo
  }
}
```

```graphql:src/components/TodoItem/index.graphql:
# OK
fragment TodoItem_Todo on Todo {
  title
  done
}

# NG
fragment TodoItem on Todo {
  title
  done
}

fragment Todos_Todo on Todo {
  title
  done
}
```

:::

```bash
$ eslint .

/.../eslint-graphql-operation-naming-convenstion-sample/src/components/TodoItem/index.graphql
   8:10  error  Fragment "TodoItem" should have prefix "TodoItem" and suffix "_Todo"    customRule/graphql-operation-naming-convention
  13:10  error  Fragment "Todos_Todo" should have prefix "TodoItem" and suffix "_Todo"  customRule/graphql-operation-naming-convention

/.../eslint-graphql-operation-naming-convenstion-sample/src/components/TodoList/index.graphql
  10:7  error  Operation "TodoList" should have prefix "TodoList" and suffix "Query"    customRule/graphql-operation-naming-convention
  17:7  error  Operation "TodosQuery" should have prefix "TodoList" and suffix "Query"  customRule/graphql-operation-naming-convention

âœ– 4 problems (4 errors, 0 warnings)
```

# ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆ

graphql-eslintã¯[eslint.RuleTester](https://eslint.org/docs/latest/integrate/nodejs-api#ruletester)ã‚’ãƒ©ãƒƒãƒ—ã—ãŸãƒ†ã‚¹ãƒˆãƒ©ãƒ³ãƒŠãƒ¼ã§ã‚ã‚‹`GraphQLRuleTester`ã‚‚æä¾›ã—ã¦ãŠã‚Šã€ã“ã¡ã‚‰ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆã‚‚è¡Œãˆã¾ã™ã€‚

åŸºæœ¬çš„ã«ã¯æ­£å¸¸ç³»ã§ã‚ã‚Œã°`code`ã‚’ã€ç•°å¸¸ç³»ã§ã‚ã‚Œã°`code`ã¨`errors`ã‚’æŒ‡å®šã™ã‚‹ã ã‘ã§ãƒ†ã‚¹ãƒˆã¯å®Ÿè¡Œã§ãã¾ã™ã€‚ä»Šå›ä½œæˆã—ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã§ã¯GraphQLã‚¹ã‚­ãƒ¼ãƒã¨ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ±ã‚‚å¿…è¦ãªã®ã§ã€è¿½åŠ ã§ã‚¹ã‚­ãƒ¼ãƒã¨`filename`ã‚’æŒ‡å®šã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

```typescript
import { join } from "path";
import rule from "../graphql-operation-naming-convention";
import { GraphQLRuleTester } from "@graphql-eslint/eslint-plugin";

const TEST_SCHEMA = /* GraphQL */ `
  type Query {
    todos: [Todo!]!
  }
  type Todo {
    id: Int!
  }
`;

const ruleTester = new GraphQLRuleTester({ schema: TEST_SCHEMA });
ruleTester.runGraphQLTests("graphql-operation-naming-convention", rule, {
  valid: [
    {
      filename: join(__dirname, "TodoItem.graphql"),
      code: "fragment TodoItem_Todo on Todo { id }",
    },
  ],
  invalid: [
    {
      filename: join(__dirname, "TodoItem.graphql"),
      code: "fragment TodoItem on Todo { id }",
      errors: [
        {
          message: `Fragment "TodoItem" should have prefix "TodoItem" and suffix "_Todo"`,
        },
      ],
    },
  ],
});
```

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã”ã¨ã«æŒ‡å®šã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```typescript
const WITH_SCHEMA = {
  parserOptions: {
    schema: TEST_SCHEMA,
  },
};

const ruleTester = new GraphQLRuleTester();
ruleTester.runGraphQLTests("graphql-operation-naming-convention", rule, {
  valid: [
    {
      ...WITH_SCHEMA,
      filename: join(__dirname, "TodoItem.graphql"),
      code: "fragment TodoItem_Todo on Todo { id }",
    },
  ],
});
```

# ã¾ã¨ã‚

graphql-eslintã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ã€æ€ã£ãŸä»¥ä¸Šã«ç°¡å˜ã«GraphQLã«å¯¾ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸï¼æ°—ãŒå‘ã„ãŸã‚‰ã‚‚ã†å°‘ã—æ±ç”¨çš„ã«ã—ã¦ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦å…¬é–‹ã§ããŸã‚‰ãªã¨æ€ã„ã¾ã™ã€‚
GraphQLã«å¯¾ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’ä½œæˆã—ãŸã„å ´åˆã¯ã€ãœã²åˆ©ç”¨ã—ã¦ã¿ã¦ãã ã•ã„ï¼
